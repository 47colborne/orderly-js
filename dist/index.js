!function(t,e){"object"==typeof exports&&"object"==typeof module?module.exports=e():"function"==typeof define&&define.amd?define("Orderly",[],e):"object"==typeof exports?exports.Orderly=e():t.Orderly=e()}(this,function(){return function(t){function e(r){if(n[r])return n[r].exports;var i=n[r]={exports:{},id:r,loaded:!1};return t[r].call(i.exports,i,i.exports,e),i.loaded=!0,i.exports}var n={};return e.m=t,e.c=n,e.p="",e(0)}([function(t,e,n){t.exports=n(1)},function(t,e,n){"use strict";t.exports=n(2)},function(t,e,n){"use strict";function r(t){return t&&t.__esModule?t:{"default":t}}function i(){function t(t){var e=arguments.length<=1||void 0===arguments[1]?{}:arguments[1],n=new a["default"](t,e),r=new s["default"]({action:n.execute,priority:e.priority});return y.add(r),n}function e(e){var n=arguments.length<=1||void 0===arguments[1]?{}:arguments[1];return t(e,Object.assign(n,{method:"GET"}))}function n(e){var n=arguments.length<=1||void 0===arguments[1]?{}:arguments[1];return t(e,Object.assign(n,{method:"POST"}))}function r(e){var n=arguments.length<=1||void 0===arguments[1]?{}:arguments[1];return t(e,Object.assign(n,{method:"PUT"}))}function i(e){var n=arguments.length<=1||void 0===arguments[1]?{}:arguments[1];return t(e,Object.assign(n,{method:"DELETE"}))}var u=arguments.length<=0||void 0===arguments[0]?{}:arguments[0],c=u.debug,f=u.max,p=u.sleep;(0,o.setMode)(c);var y=new l["default"],h=new d["default"](y,{max:f,sleep:p});return{ajax:t,get:e,post:n,put:r,del:i,queue:y,worker:h}}Object.defineProperty(e,"__esModule",{value:!0});var o=n(3),u=n(4),a=r(u),c=n(9),s=r(c),f=n(10),l=r(f),p=n(13),d=r(p);e["default"]=i},function(t,e){"use strict";function n(t){return u=t}function r(){return u}function i(t,e){var n=arguments.length<=2||void 0===arguments[2]?{}:arguments[2];if(u){var r=Object.keys(n).reduce(function(t,e){var r=n[e];return"object"===("undefined"==typeof r?"undefined":o(r))&&(r=JSON.stringify(r)),t+" "+e+":"+r},t);r=r+" "+e,console.log(r)}}Object.defineProperty(e,"__esModule",{value:!0});var o="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol?"symbol":typeof t},u=!1;e.setMode=n,e.getMode=r,e.log=i},function(t,e,n){"use strict";function r(t){return t&&t.__esModule?t:{"default":t}}function i(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}function o(t,e){var n={};for(var r in t)e.indexOf(r)>=0||Object.prototype.hasOwnProperty.call(t,r)&&(n[r]=t[r]);return n}function u(t,e,n){(0,x.log)("Ajax",t,{url:e.key,id:e.id,priority:n})}function a(t){for(var e=arguments.length,n=Array(e>1?e-1:0),r=1;r<e;r++)n[r-1]=arguments[r];return t.some(function(t){return t.apply(void 0,n)})}function c(t,e){return a(t)||e.sentIsOutdated()}function s(t,e,n,r,i){return a(e,t)||n.receivedIsOutdated()?(u("CANCELLED",n,r),t=b({},t,{status:_}),i(t)):void u("RECEIVED",n,r)}function f(t,e,n){t[e]=n}function l(t,e){return new Headers(b({},t,(0,g.requestContentType)(e)))}function p(t,e){return t&&"json"===e?JSON.stringify(t):t}function d(t,e){var n=e.headers,r=e.body,i=e.type,u=o(e,["headers","body","type"]);return n=l(n,i),r=p(r,i),new Request(t,b({},u,{headers:n,body:r}))}function y(t,e,n){var r=e.type,i=e.priority;return function(e,o){return function(a){return c(a,n)?(u("SKIPPED",n,i),o({status:j})):(n.sent(),u("SENT",n,i),fetch(t).then((0,m.proxy)(s,a,n,i,o)).then((0,m.proxy)(n.received)).then((0,m.proxy)(f,P,n)).then((0,m.proxy)(g.responseContentType,r)).then(e)["catch"](o))}}}function h(t,e){return function(){return t(e)}}Object.defineProperty(e,"__esModule",{value:!0});var v=function(){function t(t,e){for(var n=0;n<e.length;n++){var r=e[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(t,r.key,r)}}return function(e,n,r){return n&&t(e.prototype,n),r&&t(e,r),e}}(),b=Object.assign||function(t){for(var e=1;e<arguments.length;e++){var n=arguments[e];for(var r in n)Object.prototype.hasOwnProperty.call(n,r)&&(t[r]=n[r])}return t},m=n(5),g=n(6),w=n(7),x=n(3),O=n(8),k=r(O),j="skipped",_="cancelled",P="_v",E=function(){function t(e){var n=this,r=arguments.length<=1||void 0===arguments[1]?{}:arguments[1],a=r.version,c=o(r,["version"]);i(this,t),a=new k["default"]((0,w.filterParams)(e),a);var s=d(e,c),f=y(s,c,a);this.conditions=[],this.q=new Promise(function(t,e){f=f(t,e),n.execute=h(f,n.conditions)}),u("CREATED",a,c.priority)}return v(t,[{key:"cancel",value:function(t){return this.conditions.push(t),this}},{key:"catch",value:function(t){return this.q=this.q["catch"](t),this}},{key:"fail",value:function(t){return this.then((0,m.onFail)(t))}},{key:"success",value:function(t){return this.then((0,m.onSuccess)(t))}},{key:"then",value:function(t){return this.q=this.q.then(t),this}}]),t}();e["default"]=E},function(t,e){"use strict";function n(t){for(var e=arguments.length,n=Array(e>1?e-1:0),r=1;r<e;r++)n[r-1]=arguments[r];return function(e){return t.apply(void 0,[e].concat(n)),e}}function r(t,e){return function(n){return e(n)&&(n=t(n)),n}}function i(t,e){return r(t,function(t){return t.status>=400})}function o(t,e){return r(t,function(t){return t.status<400})}Object.defineProperty(e,"__esModule",{value:!0}),e.proxy=n,e.proxyWithCondition=r,e.onFail=i,e.onSuccess=o},function(t,e){"use strict";function n(t){return function(){var e=t.apply(this,arguments);return new Promise(function(t,n){function r(i,o){try{var u=e[i](o),a=u.value}catch(c){return void n(c)}return u.done?void t(a):Promise.resolve(a).then(function(t){return r("next",t)},function(t){return r("throw",t)})}return r("next")})}}function r(t){return t._bodyBlob.type.includes("application/json")}function i(t){if(t)return{Accept:"application/json","Content-Type":"application/json"}}Object.defineProperty(e,"__esModule",{value:!0});var o=function(){var t=n(regeneratorRuntime.mark(function e(t,n){return regeneratorRuntime.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:if(!n){e.next=6;break}return e.next=3,t[n]();case 3:t.data=e.sent,e.next=10;break;case 6:if(!r(t)){e.next=10;break}return e.next=9,t.json();case 9:t.data=e.sent;case 10:case"end":return e.stop()}},e,this)}));return function(e,n){return t.apply(this,arguments)}}();e.bodyContainsJson=r,e.responseContentType=o,e.requestContentType=i},function(t,e){"use strict";function n(t){return t.toString().replace(r,"")}Object.defineProperty(e,"__esModule",{value:!0});var r=new RegExp(/\?.*$/);e.filterParams=n},function(t,e){"use strict";function n(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}function r(){return{counter:0,sent:0,received:0}}Object.defineProperty(e,"__esModule",{value:!0});var i=function(){function t(t,e){for(var n=0;n<e.length;n++){var r=e[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(t,r.key,r)}}return function(e,n,r){return n&&t(e.prototype,n),r&&t(e,r),e}}(),o=function(){function t(e,r){n(this,t),u.call(this),this.check=void 0===r||r,this.key=e,this.id=t.inc(e)}return i(t,[{key:"keyIsOyutdated",value:function(e){return this.check&&t.get(this.key)[e]>this.id}}]),t}();o.map={},o.get=function(t){return this.map[t]||(this.map[t]=r())},o.inc=function(t){return this.get(t).counter+=1};var u=function(){var t=this;this.sentIsOutdated=function(){return t.keyIsOyutdated("sent")},this.receivedIsOutdated=function(){return t.keyIsOyutdated("received")},this.sent=function(){var e=o.get(t.key);if(e.sent<t.id)return e.sent=t.id},this.received=function(){var e=o.get(t.key);if(e.received<t.id)return e.received=t.id}};e["default"]=o},function(t,e){"use strict";function n(t){return function(){var e=t.apply(this,arguments);return new Promise(function(t,n){function r(i,o){try{var u=e[i](o),a=u.value}catch(c){return void n(c)}return u.done?void t(a):Promise.resolve(a).then(function(t){return r("next",t)},function(t){return r("throw",t)})}return r("next")})}}function r(t,e){var n={};for(var r in t)e.indexOf(r)>=0||Object.prototype.hasOwnProperty.call(t,r)&&(n[r]=t[r]);return n}function i(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}Object.defineProperty(e,"__esModule",{value:!0});var o=function u(){var t=this,e=arguments.length<=0||void 0===arguments[0]?{}:arguments[0],o=e.action,a=e.priority,c=void 0===a?0:a,s=r(e,["action","priority"]);i(this,u),this.execute=function(){var e=n(regeneratorRuntime.mark(function r(e){var n;return regeneratorRuntime.wrap(function(r){for(;;)switch(r.prev=r.next){case 0:return r.next=2,t.action();case 2:return n=r.sent,e&&"function"==typeof e&&e(n),r.abrupt("return",n);case 5:case"end":return r.stop()}},r,t)}));return function(t){return e.apply(this,arguments)}}(),this.action=o,this.priority=c,this.options=s};e["default"]=o},function(t,e,n){"use strict";function r(t){return t&&t.__esModule?t:{"default":t}}function i(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}function o(t,e){var n=t.priority,r=e.priority;return void 0===r||n>r}Object.defineProperty(e,"__esModule",{value:!0});var u="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol?"symbol":typeof t},a=function(){function t(t,e){for(var n=0;n<e.length;n++){var r=e[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(t,r.key,r)}}return function(e,n,r){return n&&t(e.prototype,n),r&&t(e,r),e}}(),c=n(11),s=r(c),f=n(3),l=function(){function t(){var e=arguments.length<=0||void 0===arguments[0]?{}:arguments[0],n=e.strategy,r=void 0===n?o:n;i(this,t),this.queue=new s["default"](r)}return a(t,[{key:"add",value:function(t){if("object"===("undefined"==typeof t?"undefined":u(t))&&"function"==typeof t.action)return this.queue.add(t),t;throw new Error("trying to insert an invalid job",t)}},{key:"get",value:function(){return(0,f.log)("Queue","getting a job",{size:this.size()}),this.queue.poll()}},{key:"isEmpty",value:function(){return this.queue.isEmpty()}},{key:"size",value:function(){return this.queue.size}},{key:"cleanup",value:function(){return this.queue.trim()}}]),t}();e["default"]=l},function(t,e,n){(function(t){"use strict";function e(t){this.array=[],this.size=0,this.compare=t||r}var r=function(t,e){return t<e};e.prototype.add=function(t){var e=this.size;for(this.array[this.size++]=t;e>0;){var n=e-1>>1,r=this.array[n];if(!this.compare(t,r))break;this.array[e]=r,e=n}this.array[e]=t},e.prototype.heapify=function(t){this.array=t,this.size=t.length;for(var e=this.size>>1;e>=0;e--)this._percolateDown(e)},e.prototype._percolateUp=function(t){for(var e=this.array[t];t>0;){var n=t-1>>1,r=this.array[n];if(!this.compare(e,r))break;this.array[t]=r,t=n}this.array[t]=e},e.prototype._percolateDown=function(t){for(var e=this.size,n=this.size>>>1,r=this.array[t];t<n;){var i=(t<<1)+1,o=i+1,u=this.array[i];if(o<e&&this.compare(this.array[o],u)&&(i=o,u=this.array[o]),!this.compare(u,r))break;this.array[t]=u,t=i}this.array[t]=r},e.prototype.peek=function(t){return this.array[0]},e.prototype.poll=function(t){var e=this.array[0];return this.size>1?(this.array[0]=this.array[--this.size],this._percolateDown(0)):--this.size,e},e.prototype.trim=function(){this.array=this.array.slice(0,this.size)},e.prototype.isEmpty=function(t){return 0==this.size};var i=function(){var t=new e(function(t,e){return t<e});for(t.add(1),t.add(0),t.add(5),t.add(4),t.add(3);!t.isEmpty();)console.log(t.poll())};n.c[0]===t&&i(),t.exports=e}).call(e,n(12)(t))},function(t,e){"use strict";t.exports=function(t){return t.webpackPolyfill||(t.deprecate=function(){},t.paths=[],t.children=[],t.webpackPolyfill=1),t}},function(t,e){"use strict";function n(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}function r(t,e){return t<=e}function i(t){return!t.isEmpty()}function o(t){for(var e=arguments.length,n=Array(e>1?e-1:0),r=1;r<e;r++)n[r-1]=arguments[r];return setTimeout.apply(void 0,[t,0].concat(n))}Object.defineProperty(e,"__esModule",{value:!0});var u=function(){function t(t,e){for(var n=0;n<e.length;n++){var r=e[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(t,r.key,r)}}return function(e,n,r){return n&&t(e.prototype,n),r&&t(e,r),e}}(),a=function(){function t(e){var r=arguments.length<=1||void 0===arguments[1]?{}:arguments[1],i=r.sleep,o=void 0===i?50:i,u=r.max,a=void 0===u?8:u;n(this,t),c.call(this),this.pending=0,this["continue"]=!0,this.start(e,o,a)}return u(t,[{key:"stop",value:function(){this["continue"]=!1,clearTimeout(this.setTimeout)}}]),t}(),c=function(){var t=this;this.start=function(e,n,u){for(;t["continue"]&&r(t.pending,u)&&i(e);){t.pending+=1;var a=e.get();o(a.execute,t.complete)}t["continue"]&&(e.cleanup(),t.setTimeout=setTimeout(t.start,n,e,n,u))},this.complete=function(){t.pending-=1}};e["default"]=a}])});
//# sourceMappingURL=index.js.map